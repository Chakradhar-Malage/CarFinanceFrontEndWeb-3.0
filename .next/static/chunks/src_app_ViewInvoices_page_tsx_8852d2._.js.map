{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/chaku/OneDrive/Desktop/CarFinanceFrontendWeb/src/app/ViewInvoices/page.tsx"],"sourcesContent":["\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n\r\n\"use client\";\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'next/navigation';\r\nimport { FaTrash } from 'react-icons/fa';\r\nimport Image from 'next/image';\r\n\r\nconst ViewInvoices = () => {\r\n  interface Invoice {\r\n    customer_name: string;\r\n    created_at: string;\r\n  }\r\n\r\n  const [invoices, setInvoices] = useState<Invoice[]>([]);\r\n  const [searchName, setSearchName] = useState('');\r\n  const [filteredInvoices, setFilteredInvoices] = useState<Invoice[]>([]);\r\n  const router = useRouter();\r\n\r\n  // Component to format a date string for display (MM/DD/YYYY at HH:mm:ss)\r\n  const FormattedDate = ({ dateString }: { dateString: string }) => {\r\n    const date = new Date(dateString);\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const year = date.getFullYear();\r\n    const hours = String(date.getHours()).padStart(2, '0');\r\n    const minutes = String(date.getMinutes()).padStart(2, '0');\r\n    const seconds = String(date.getSeconds()).padStart(2, '0');\r\n    return (\r\n      <span>\r\n        {month}/{day}/{year} at {hours}:{minutes}:{seconds}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  // Helper function to format a date string for URL usage (YYYY-MM-DD HH:mm:ss)\r\n  const formatDateForUrl = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const year = date.getFullYear();\r\n    const hours = String(date.getHours()).padStart(2, '0');\r\n    const minutes = String(date.getMinutes()).padStart(2, '0');\r\n    const seconds = String(date.getSeconds()).padStart(2, '0');\r\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchInvoices();\r\n  }, []);\r\n\r\n  const fetchInvoices = async () => {\r\n    try {\r\n      const response = await axios.get('http://15.207.48.53:3000/allinvoices');\r\n      setInvoices(response.data as Invoice[]);\r\n      setFilteredInvoices(response.data as Invoice[]);\r\n    } catch (error) {\r\n      console.error('Error fetching invoices:', error);\r\n    }\r\n  };\r\n\r\n  const searchByCustomer = async () => {\r\n    if (!searchName) {\r\n      window.alert('Please enter a customer name.');\r\n      return;\r\n    }\r\n    try {\r\n      const response = await axios.get(\r\n        `http://15.207.48.53:3000/invoices/customer/${searchName}`\r\n      );\r\n      setFilteredInvoices(response.data as Invoice[]);\r\n    } catch (error) {\r\n      console.error('Error searching invoices:', error);\r\n      window.alert('No invoices found for this customer.');\r\n    }\r\n  };\r\n\r\n  const openInBrowser = (customerName: string, createdAt: string) => {\r\n    const formattedDate = formatDateForUrl(createdAt);\r\n    const encodedCreatedAt = encodeURIComponent(formattedDate);\r\n    const url = `http://15.207.48.53:3000/invoices/${customerName}/${encodedCreatedAt}/download`;\r\n    window.open(url, '_blank');\r\n  };\r\n\r\n  const deleteInvoice = async (customerName: string, createdAt: string) => {\r\n    const formattedDate = formatDateForUrl(createdAt);\r\n    const encodedCreatedAt = encodeURIComponent(formattedDate);\r\n    const url = `http://15.207.48.53:3000/deleteinvoices/${customerName}/${encodedCreatedAt}`;\r\n    try {\r\n      await axios.delete(url);\r\n      // Update both states to remove the deleted invoice\r\n      setInvoices(prev =>\r\n        prev.filter(\r\n          invoice =>\r\n            !(invoice.customer_name === customerName && invoice.created_at === createdAt)\r\n        )\r\n      );\r\n      setFilteredInvoices(prev =>\r\n        prev.filter(\r\n          invoice =>\r\n            !(invoice.customer_name === customerName && invoice.created_at === createdAt)\r\n        )\r\n      );\r\n      window.alert('Invoice deleted successfully');\r\n    } catch (error) {\r\n      console.error('Error deleting invoice:', error);\r\n      window.alert('Failed to delete invoice');\r\n    }\r\n  };\r\n\r\n  const confirmDeleteInvoice = (customerName: string, createdAt: string) => {\r\n    if (window.confirm('Are you sure you want to delete this invoice?')) {\r\n      deleteInvoice(customerName, createdAt);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      {/* Header with User Info */}\r\n      <div className=\"header-container\">\r\n        <div className=\"user-img\">\r\n          <Image src=\"/webbuild/images/usericon.png\" alt=\"User Icon\" width={50} height={50} />\r\n        </div>\r\n        <div className=\"user-info\">\r\n          <p className=\"helloname\">Hello,</p>\r\n          <p className=\"username\">OmSai</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation Buttons */}\r\n      <div className=\"buttons-container\">\r\n        <button className=\"view-invoices-button\" onClick={() => router.push('/GenerateInvoice')}>\r\n          New Invoice\r\n        </button>\r\n        <button className=\"view-invoices-button\" onClick={() => router.push('/GstBilling_ledger')}>\r\n          Billing Ledger\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search Section */}\r\n      <input\r\n        type=\"text\"\r\n        className=\"search-input\"\r\n        placeholder=\"Search by customer name\"\r\n        value={searchName}\r\n        onChange={(e) => setSearchName(e.target.value)}\r\n      />\r\n      <button className=\"search-button\" onClick={searchByCustomer}>\r\n        Search\r\n      </button>\r\n\r\n      {/* Invoice List */}\r\n      <div className=\"invoices-list\">\r\n        {filteredInvoices.map((item, index) => (\r\n          <div key={index} className=\"invoice-item\">\r\n            <div\r\n              className=\"delete-icon\"\r\n              onClick={() => confirmDeleteInvoice(item.customer_name, item.created_at)}\r\n            >\r\n              <FaTrash size={24} color=\"red\" />\r\n            </div>\r\n            <p className=\"invoice-text\">Customer: {item.customer_name}</p>\r\n            <p>\r\n              <FormattedDate dateString={item.created_at} />\r\n            </p>\r\n            <button\r\n              className=\"download-button\"\r\n              onClick={() => openInBrowser(item.customer_name, item.created_at)}\r\n            >\r\n              Download\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        .container {\r\n          padding: 20px;\r\n        }\r\n        .header-container {\r\n          display: flex;\r\n          align-items: center;\r\n          margin-bottom: 20px;\r\n        }\r\n        .user-img {\r\n          width: 50px;\r\n          height: 50px;\r\n          border-radius: 20px;\r\n          overflow: hidden;\r\n        }\r\n        .user-info {\r\n          margin-left: 10px;\r\n        }\r\n        .helloname {\r\n          font-size: 14px;\r\n          color: gray;\r\n          margin: 0;\r\n        }\r\n        .username {\r\n          font-size: 18px;\r\n          font-weight: bold;\r\n          color: darkslategrey;\r\n          margin: 0;\r\n        }\r\n        .buttons-container {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          margin-bottom: 20px;\r\n        }\r\n        .view-invoices-button {\r\n          padding: 10px;\r\n          width: 48%;\r\n          background-color: #841584;\r\n          border: none;\r\n          border-radius: 18px;\r\n          color: white;\r\n          font-size: 16px;\r\n          cursor: pointer;\r\n        }\r\n        .search-input {\r\n          height: 40px;\r\n          width: 100%;\r\n          border: 1px solid gray;\r\n          margin-bottom: 12px;\r\n          padding: 8px;\r\n          border-radius: 5px;\r\n          box-sizing: border-box;\r\n        }\r\n        .search-button {\r\n          background-color: #841584;\r\n          padding: 10px 0;\r\n          border: none;\r\n          border-radius: 5px;\r\n          margin-bottom: 20px;\r\n          width: 100%;\r\n          color: white;\r\n          font-size: 16px;\r\n          cursor: pointer;\r\n        }\r\n        .invoice-item {\r\n          position: relative;\r\n          padding: 16px;\r\n          border-bottom: 1px solid gray;\r\n          background-color: #f9f9f9;\r\n          margin: 8px 0;\r\n          border-radius: 5px;\r\n        }\r\n        .invoice-text {\r\n          font-size: 16px;\r\n          margin-bottom: 8px;\r\n        }\r\n        .delete-icon {\r\n          position: absolute;\r\n          top: 8px;\r\n          right: 8px;\r\n          z-index: 1;\r\n          cursor: pointer;\r\n        }\r\n        .download-button {\r\n          background-color: darkslategrey;\r\n          padding: 10px;\r\n          border: none;\r\n          border-radius: 5px;\r\n          margin-top: 10px;\r\n          color: white;\r\n          font-size: 16px;\r\n          cursor: pointer;\r\n          width: 100%;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ViewInvoices;\r\n"],"names":[],"mappings":"AACA,oDAAoD;;;;;AAIpD;AAEA;AAEA;AAHA;AAEA;;;AALA;;;;;;;AAQA,MAAM,eAAe;;IAMnB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtE,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,yEAAyE;IACzE,MAAM,gBAAgB,CAAC,EAAE,UAAU,EAA0B;QAC3D,MAAM,OAAO,IAAI,KAAK;QACtB,MAAM,MAAM,OAAO,KAAK,OAAO,IAAI,QAAQ,CAAC,GAAG;QAC/C,MAAM,QAAQ,OAAO,KAAK,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;QACtD,MAAM,OAAO,KAAK,WAAW;QAC7B,MAAM,QAAQ,OAAO,KAAK,QAAQ,IAAI,QAAQ,CAAC,GAAG;QAClD,MAAM,UAAU,OAAO,KAAK,UAAU,IAAI,QAAQ,CAAC,GAAG;QACtD,MAAM,UAAU,OAAO,KAAK,UAAU,IAAI,QAAQ,CAAC,GAAG;QACtD,qBACE,6LAAC;;gBACE;gBAAM;gBAAE;gBAAI;gBAAE;gBAAK;gBAAK;gBAAM;gBAAE;gBAAQ;gBAAE;;;;;;;IAGjD;IAEA,8EAA8E;IAC9E,MAAM,mBAAmB,CAAC;QACxB,MAAM,OAAO,IAAI,KAAK;QACtB,MAAM,MAAM,OAAO,KAAK,OAAO,IAAI,QAAQ,CAAC,GAAG;QAC/C,MAAM,QAAQ,OAAO,KAAK,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;QACtD,MAAM,OAAO,KAAK,WAAW;QAC7B,MAAM,QAAQ,OAAO,KAAK,QAAQ,IAAI,QAAQ,CAAC,GAAG;QAClD,MAAM,UAAU,OAAO,KAAK,UAAU,IAAI,QAAQ,CAAC,GAAG;QACtD,MAAM,UAAU,OAAO,KAAK,UAAU,IAAI,QAAQ,CAAC,GAAG;QACtD,OAAO,GAAG,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,IAAI,CAAC,EAAE,MAAM,CAAC,EAAE,QAAQ,CAAC,EAAE,SAAS;IACjE;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR;QACF;iCAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,IAAI;YACF,MAAM,WAAW,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;YACjC,YAAY,SAAS,IAAI;YACzB,oBAAoB,SAAS,IAAI;QACnC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,MAAM,mBAAmB;QACvB,IAAI,CAAC,YAAY;YACf,OAAO,KAAK,CAAC;YACb;QACF;QACA,IAAI;YACF,MAAM,WAAW,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAC9B,CAAC,2CAA2C,EAAE,YAAY;YAE5D,oBAAoB,SAAS,IAAI;QACnC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,OAAO,KAAK,CAAC;QACf;IACF;IAEA,MAAM,gBAAgB,CAAC,cAAsB;QAC3C,MAAM,gBAAgB,iBAAiB;QACvC,MAAM,mBAAmB,mBAAmB;QAC5C,MAAM,MAAM,CAAC,kCAAkC,EAAE,aAAa,CAAC,EAAE,iBAAiB,SAAS,CAAC;QAC5F,OAAO,IAAI,CAAC,KAAK;IACnB;IAEA,MAAM,gBAAgB,OAAO,cAAsB;QACjD,MAAM,gBAAgB,iBAAiB;QACvC,MAAM,mBAAmB,mBAAmB;QAC5C,MAAM,MAAM,CAAC,wCAAwC,EAAE,aAAa,CAAC,EAAE,kBAAkB;QACzF,IAAI;YACF,MAAM,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;YACnB,mDAAmD;YACnD,YAAY,CAAA,OACV,KAAK,MAAM,CACT,CAAA,UACE,CAAC,CAAC,QAAQ,aAAa,KAAK,gBAAgB,QAAQ,UAAU,KAAK,SAAS;YAGlF,oBAAoB,CAAA,OAClB,KAAK,MAAM,CACT,CAAA,UACE,CAAC,CAAC,QAAQ,aAAa,KAAK,gBAAgB,QAAQ,UAAU,KAAK,SAAS;YAGlF,OAAO,KAAK,CAAC;QACf,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,KAAK,CAAC;QACf;IACF;IAEA,MAAM,uBAAuB,CAAC,cAAsB;QAClD,IAAI,OAAO,OAAO,CAAC,kDAAkD;YACnE,cAAc,cAAc;QAC9B;IACF;IAEA,qBACE,6LAAC;kDAAc;;0BAEb,6LAAC;0DAAc;;kCACb,6LAAC;kEAAc;kCACb,cAAA,6LAAC,gIAAA,CAAA,UAAK;4BAAC,KAAI;4BAAgC,KAAI;4BAAY,OAAO;4BAAI,QAAQ;;;;;;;;;;;kCAEhF,6LAAC;kEAAc;;0CACb,6LAAC;0EAAY;0CAAY;;;;;;0CACzB,6LAAC;0EAAY;0CAAW;;;;;;;;;;;;;;;;;;0BAK5B,6LAAC;0DAAc;;kCACb,6LAAC;wBAAwC,SAAS,IAAM,OAAO,IAAI,CAAC;kEAAlD;kCAAuE;;;;;;kCAGzF,6LAAC;wBAAwC,SAAS,IAAM,OAAO,IAAI,CAAC;kEAAlD;kCAAyE;;;;;;;;;;;;0BAM7F,6LAAC;gBACC,MAAK;gBAEL,aAAY;gBACZ,OAAO;gBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;0DAHnC;;;;;;0BAKZ,6LAAC;gBAAiC,SAAS;0DAAzB;0BAA2C;;;;;;0BAK7D,6LAAC;0DAAc;0BACZ,iBAAiB,GAAG,CAAC,CAAC,MAAM,sBAC3B,6LAAC;kEAA0B;;0CACzB,6LAAC;gCAEC,SAAS,IAAM,qBAAqB,KAAK,aAAa,EAAE,KAAK,UAAU;0EAD7D;0CAGV,cAAA,6LAAC,iJAAA,CAAA,UAAO;oCAAC,MAAM;oCAAI,OAAM;;;;;;;;;;;0CAE3B,6LAAC;0EAAY;;oCAAe;oCAAW,KAAK,aAAa;;;;;;;0CACzD,6LAAC;;0CACC,cAAA,6LAAC;oCAAc,YAAY,KAAK,UAAU;;;;;;;;;;;0CAE5C,6LAAC;gCAEC,SAAS,IAAM,cAAc,KAAK,aAAa,EAAE,KAAK,UAAU;0EADtD;0CAEX;;;;;;;uBAdO;;;;;;;;;;;;;;;;;;;;AAsHpB;GAxQM;;QASW,qIAAA,CAAA,YAAS;;;KATpB;uCA0QS"}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}